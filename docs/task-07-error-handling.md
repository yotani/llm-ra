# 工作項目：錯誤處理與狀態提示

## 任務目標
在前後端實作完整的錯誤處理與狀態提示機制，提升使用者體驗。

## 規格
- **前端提示**:
  - **載入中 (Loading)**: 在 API 請求期間，顯示載入動畫或文字。
  - **成功 (Success)**: 操作成功時（如 API Key 儲存成功、分析完成），顯示短暫的成功訊息。
  - **錯誤 (Error)**: API 請求失敗、資料格式錯誤或後端回傳錯誤時，顯示清晰的錯誤訊息。
- **後端處理**:
  - **API 呼叫失敗**: 捕捉 `HttpClient` 的例外，回傳 500 或 502 錯誤。
  - **驗證失敗**: 如果前端傳來的資料無效（如 API Key 格式不對），回傳 400 Bad Request。
  - **權限問題**: 如果 API Key 無效，回傳 401 Unauthorized。
  - **統一錯誤格式**: 設計一個標準的 JSON 錯誤回應格式，例如 `{ "statusCode": 500, "message": "無法連接至 Anything LLM API。" }`。

## 實作步驟
1.  **後端實作**:
    -   使用 .NET 的 Middleware 或 `try-catch` 區塊來捕捉全域例外。
    -   在各個 Controller 的 Action 中，針對特定錯誤情況回傳對應的 HTTP 狀態碼和錯誤訊息。
2.  **前端 UI 元件**:
    -   在 HTML 中建立一個通用的提示框元件（Toast/Snackbar）或一個固定的訊息顯示區域。
3.  **前端 JavaScript 邏輯**:
    -   在發送 API 請求前，顯示「載入中」狀態。
    -   在 `fetch` 或 `axios` 的 `.then()` 中處理成功的回應，顯示成功訊息並隱藏載入狀態。
    -   在 `.catch()` 中處理失敗的回應，讀取後端回傳的錯誤訊息並顯示在 UI 上，同時隱藏載入狀態。
    -   為不同的操作（儲存 Key、分析資料）提供對應的提示訊息。

## 驗收標準
-   當後端 API 發生錯誤時，前端能顯示對應的錯誤訊息，而不是崩潰或沒有反應。
-   在等待 API 回應時，前端會顯示載入提示。
-   操作成功後，前端會給予使用者正向的回饋。
-   後端能針對不同類型的錯誤回傳不同的 HTTP 狀態碼。
